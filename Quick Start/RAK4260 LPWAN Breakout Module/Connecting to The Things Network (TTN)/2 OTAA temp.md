---
type: page
title: OTAA temp
listed: false
slug: otaa-temp
---published

When setting up a new device in TTN its default is to join in OTAA mode. For configuration, you need the following three parameters: **Device EUI, Application EUI** and **App Key**. These can be obtained from the **Device Overview** page, where they are grouped one after the other for convenience as shown in Figure 1.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588870594\/29193\/titym1xtsycao0xtuvow.png",
        "mode": "responsive",
        "width": 1115,
        "height": 1007,
        "caption": "**Figure 1**: Device Overview Parameters"
    }
}]$

As these are randomly generated by TTN we need to update our RAK4260 LPWAN Breakout Module with their values in order to be able to register it with the network. However, as mentioned
before, you can only do this directly in the source code, compile it and then
flash it to the device. The following section will guide you through the
process of doing this with the Atmel Studio.

## Parameter and Firmware Setup

We need to execute these steps in order for our device to connect with TTN, basically fill in the parameters we obtained by already registering it beforehand.

### Edit OTAA Parameters in the Code

- Open your Atmel Studio and navigate to the demo firmware you downloaded from the [RAKwireless GitHub repository](https://github.com/RAKWireless/RAK4260-LoRaNode-demo).

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588911906\/29193\/ggirixomqcb0wxnngvjj.png",
        "mode": "600",
        "width": 1114,
        "height": 1217,
        "caption": "**Figure 2**: Atmel Studio main page"
    }
}]$

- Go to `File → Open → Project/Solution:`

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588912062\/29193\/jpcvzi6jrqgnfdbx9ojc.png",
        "mode": "600",
        "width": 1114,
        "height": 1217,
        "caption": "**Figure 3**: Open the sample project"
    }
}]$

- Go to the folder where you downloaded the GitHub repository and select the "APPS_ENDDEVICE___DEMO1" project file (it is in the directory with the same name as the file). Open it.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588912253\/29193\/leo7uggnzryeerdlo0xz.png",
        "mode": "600",
        "width": 1114,
        "height": 1217,
        "caption": "**Figure 4**: Demo firmware project file"
    }
}]$

- Once your project has loaded up you will be presented with a file structure that contains folders and files that you can edit. You need to copy the values of the 3 parameters in Figure 1 (**Device and Application EUI plus the Application Key**) into the corresponding fields in the “**conf_app.h**” file. It is contained in the scr  config folder that you can access via the tree. You can use Figure 15 as reference if you have trouble finding the file.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588912699\/29193\/u5mrhaogsdroaglr9bp5.png",
        "mode": "600",
        "width": 1934,
        "height": 2114,
        "caption": "**Figure 5**: Device configuration file (OTAA parameters)"
    }
}]$

- Once you have replaced the default values with the one for the device you registered with TTN, you can proceed to compiling the firmware file. There is no real need to edit anything else in order to make a firmware that will allow you to connect to the network.

### Compile the Code

- Compile the code by going to the `Build → Build Solution` (Figure 6).

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588912903\/29193\/uqbd1c5efusywwtxmgs1.png",
        "mode": "600",
        "width": 1934,
        "height": 2114,
        "caption": "**Figure 6**: Compiling the code"
    }
}]$

- The Output should have no errors (Figure 7)

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588913000\/29193\/p18j52wqws8p03lavamf.png",
        "mode": "600",
        "width": 1911,
        "height": 458,
        "caption": "**Figure 7**: Successful compiling of the code"
    }
}]$

### Flashing the firmware

- Once compiled you can find the output file in the “**Debug**” folder of the directory where you downloaded the firmware (Figure 5):

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588919414\/29193\/qvozkxkbndhmckrtbjqy.png",
        "mode": "responsive",
        "width": 1388,
        "height": 648,
        "caption": "**Figure 8**: Firmware .hex file"
    }
}]$

- As the firmware is ready now you are going to proceed to flashing it. In order to do this, you need to utilize your J-link hardware tool and the J-link Flasher software tool.
- Connect the J-link tool in accordance with the diagram shown the [Interfacing with RAK4260 LPWAN Breakout Module](/quick-start/rak4260-lpwan-breakout-module/interfacing-with-rak4260-lpwan-breakout-module#j-link-connection) in section.
- Afterwhich, folow the steps in the [auto$](/rak4260-lpwan-breakout-module/burning-the-firmware) section using the .hex firmware "**Debug**" folder in Figure 8.

You are now done with flashing the modified firmware and can close the J-Flash tool and disconnect the J-link tool as you will not need it for the next step.

## Connecting to TTN

- Connect your USB to UART converter to the pin header on the RAK4260 via a set of 4 dupont lines. Refer to the [Interfacing with RAK4260 LPWAN Breakout Module](/quick-start/rak4260-lpwan-breakout-module/interfacing-with-rak4260-lpwan-breakout-module#usb-to-uart) section for more details.

### Regional Band and Join Network Setup

Upon opening the RAK Serial Port Tool, it should display the same details as shown in Figure 9, provided it has been less than 5 seconds since you powered the board. The firmware is set to work in such a way that 5 seconds after powering the module it initializes with the default settings.

$plugin[{
    "type": "callout",
    "data": {
        "text": "In our example this would be the EU868 for the region. We are going to show how to change the default region and how to connect with the network.",
        "type": "info",
        "title": "Note:"
    }
}]$

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588927962\/29193\/x83yeoxx6pqcyamwq12y.png",
        "mode": "300",
        "width": 674,
        "height": 949,
        "caption": "**Figure 9**: Start up default output"
    }
}]$

- After the aforementioned 5 seconds elapse, the current configurations (**Class A, OTAA, Unconfirmed LoRa® Frames, Fport - 1**) will be reported .

$plugin[{
    "type": "callout",
    "data": {
        "text": "These settings are not adjustable at this stage and if you want to change them you need to start over at the stage where we modify the firmware files before compiling it.",
        "type": "info",
        "title": "Note:"
    }
}]$

- If you use Figure 10 as reference, you will see there is a list of 4 options to choose from. Go to the “**Main Menu**” by sending a 4.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588929233\/29193\/eczunrv0cq7xmwtmbrtl.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 10**: Configuration menu"
    }
}]$

- Afterwhich, send 1 in order to select EU868 Regional Band. You may also choose a different number as selection depending on your case.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588929638\/29193\/sl7l89gtxugiyvohsxtr.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 11**: Band selection menu"
    }
}]$

- After you have selected the band, the device will automatically try to connect to the network using the **Device EUI, Application EUI and Application Key** set in the firmware configuration file. These are also reported in the window in Figure 12.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588929760\/29193\/xjb6tip3svzxziqjjplf.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 12**: Network join parameters set"
    }
}]$

- If the device was successful at joining the network, this will be reported with the Device Address it has been assigned and the parameters will be reported again (Class A, OTAA, etc.) You will be presented with the Configuration menu (Figure 10) again in case you want to execute another selection. We will do this in the next section, where we will send some uplink data to the network.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588929926\/29193\/wnje31lrslkwhadcxq6e.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 13**: Successful network join"
    }
}]$

### Uplink LoRa® Frame Testing

- You should now be in the Main menu (Figure 14) and have 4 options. This time **select Option 2** to send an uplink LoRa® Frame.

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588930169\/29193\/j2arcpvlp98d1ylq5z9u.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 14**: Sending data to the server"
    }
}]$

$plugin[{
    "type": "callout",
    "data": {
        "text": "The firmware uploaded into the RAK4260 LPWAN Breakout Module is just an example. Thus, the data sent are just dummy Temperature reading (the original Microchip code was for a board with an actual temperature sensor). It will be reported as output together with whether the transmission was successful as shown in Figure 15.",
        "type": "info",
        "title": "Note:"
    }
}]$

$plugin[{
    "type": "image",
    "data": {
        "url": "https:\/\/res.cloudinary.com\/developerhub\/image\/upload\/v1588930443\/29193\/i2wioseqog3pnzwm0vxy.png",
        "mode": "300",
        "width": 674,
        "height": 953,
        "caption": "**Figure 15**: Sending data to the server (successful)"
    }
}]$

This should be sufficient to prove that the board functions as intended and it is able to send data over the network after successfully joining it. As this module is intended for development the example firmware is limited to this functionality and you can use it as a base to develop a more complex firmware using the Microchip SDK (Atmel Studio).

